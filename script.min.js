const typewriterElement = document.getElementById("typewriter");
  const skills = ["HTML.","CSS.","Jscript.","Bootstrap.","Jquery.","MS-office.","firebase."];
  let skillIndex = 0;
  let charIndex = 0;
  let isDeleting = false;

  function typeWriter() {
    const currentSkill = skills[skillIndex];

    if (!isDeleting) {
      // Typing forward
      typewriterElement.innerHTML = currentSkill.substring(0, charIndex + 1) + '<span class="blinking-cursor">|</span>';
      charIndex++;

      if (charIndex === currentSkill.length) {
        // Pause at the end of the skill
        isDeleting = true;
        setTimeout(typeWriter, 2000); // Wait 2 seconds before deleting
      } else {
        setTimeout(typeWriter, 100); // Typing speed
      }
    } else {
      // Deleting backward
      typewriterElement.innerHTML = currentSkill.substring(0, charIndex - 1) + '<span class="blinking-cursor">|</span>';
      charIndex--;

      if (charIndex === 0) {
        // Move to the next skill
        isDeleting = false;
        skillIndex = (skillIndex + 1) % skills.length; // Loop back to the first skill
        setTimeout(typeWriter, 500); // Pause before typing the next skill
      } else {
        setTimeout(typeWriter, 100); // Deleting speed
      }
    }
  }

  // Start the typewriter effect
  typeWriter();

  function myFunction() {
     var element = document.body;
     element.classList.toggle("white-mode");
  };

var tablinks = document.getElementsByClassName("tab-links");
var tabcontents = document.getElementsByClassName("tab-contents");

function opentab(tabname){
    for(tablink of tablinks){
        tablink.classList.remove("active-link");
    }
    for(tabcontent of tabcontents){
        tabcontent.classList.remove("active-tab");
    }
    event.currentTarget.classList.add("active-link");
    document.getElementById(tabname).classList.add("active-tab");
}

var sidemenu = document.getElementById("sidemenu");

function openmenu(){
    sidemenu.style.right = "0";
}
function closemenu(){
    sidemenu.style.right = "-200px";
}

// Select the button
const backToTopButton = document.getElementById("backToTop");

// Show button when user scrolls down
window.onscroll = function () {
    if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
        backToTopButton.style.display = "block";
    } else {
        backToTopButton.style.display = "none";
    }
};

// Scroll back to top when clicked
backToTopButton.addEventListener("click", function () {
    window.scrollTo({
        top: 0,
        behavior: "smooth"
    });
});

  const scriptURL = 'https://script.google.com/macros/s/AKfycbxJ6jzTpMx-zZbZ1oSA2ibXcKi1CDFhmZtOEAgYgwX6IEeZZERsjGZ_eBWNCP4xv2EW/exec'
  const form = document.forms['submit-to-google-sheet']
  const msg = document.getElementById("msg")

  form.addEventListener('submit', e => {
    e.preventDefault()
    fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => {
        msg.innerHTML = "Message submitted successfully"
        setTimeout(function(){
          msg.innerHTML = ""
        },5000)
        form.reset()
      })
      .catch(error => console.error('Error!', error.message))
  })